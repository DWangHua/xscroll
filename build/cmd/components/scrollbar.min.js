define(function(o,t,r){var i=o("../util"),e=o("../animate"),s=60,l=8,n=i.prefixStyle("transform"),a=i.vendor?["-",i.vendor,"-transform"].join(""):"transform",c=i.prefixStyle("transition"),d=(i.prefixStyle("borderRadius"),i.prefixStyle("transitionDuration"),function(o){this.userConfig=o,this.init(o.xscroll)});return i.mix(d.prototype,{init:function(o){var t=this;t.xscroll=o,t.type=t.userConfig.type,t.isY="y"==t.type?!0:!1,t.scrollTopOrLeft=t.isY?"scrollTop":"scrollLeft";var r=t.xscroll.boundry;t.containerSize=t.isY?t.xscroll.containerHeight+r._xtop+r._xbottom:t.xscroll.containerWidth+r._xright+r._xleft,t.indicateSize=t.isY?t.xscroll.height:t.xscroll.width,t.pos=t.isY?o.getScrollTop():o.getScrollLeft(),t.render(),t._bindEvt()},destroy:function(){var o=this;o.scrollbar&&o.scrollbar.remove(),o.xscroll.off("scrollend",o._update,o),o.xscroll.off("scrollanimate",o._update,o),!o.xscroll.userConfig.useTransition&&o.xscroll.off("scroll",o._update,o),delete o},render:function(){var o=this;if(!o.__isRender){o.__isRender=!0;var t=o.xscroll,r=t.userConfig.gpuAcceleration?" translateZ(0) ":"",i=r?a+":"+r+";":"",e="opacity:0;position:absolute;z-index:999;overflow:hidden;-webkit-border-radius:3px;-moz-border-radius:3px;-o-border-radius:3px;"+i,s=o.isY?"width: 3px;bottom:5px;top:5px;right:3px;"+e:"height:3px;left:5px;right:5px;bottom:3px;"+e;o.scrollbar=document.createElement("div"),o.scrollbar.style.cssText=s,t.renderTo.appendChild(o.scrollbar);var l=o.isY?"width:100%;":"height:100%;";o.indicate=document.createElement("div"),o.indicate.style.cssText=l+"position:absolute;background:rgba(0,0,0,0.3);-webkit-border-radius:3px;-moz-border-radius:3px;-o-border-radius:3px;",o.scrollbar.appendChild(o.indicate),o._update(),o.hide(0)}},_update:function(o,t,r){var i=this,o=void 0===o?i.isY?i.xscroll.getScrollTop():i.xscroll.getScrollLeft():o,e=i.computeScrollBar(o),s=i.isY?"height":"width";i.indicate.style[s]=Math.round(e.size)+"px",t&&r?i.scrollTo(e.pos,t,r):i.moveTo(e.pos)},computeScrollBar:function(o){var t=this,o=(t.isY?"y":"x",Math.round(o)),r=10,i=t.xscroll.boundry;t.containerSize=t.isY?t.xscroll.containerHeight+i._xtop+i._xbottom:t.xscroll.containerWidth+i._xright+i._xleft,t.size=t.isY?t.xscroll.height:t.xscroll.width,t.indicateSize=t.isY?t.xscroll.height-r:t.xscroll.width-r;var e=t.indicateSize,n=t.containerSize,a=n-t.size,c=o/n,d=e*c,u=Math.round(e*t.size/n),p=d*(e-s+u)/e;if(s>u&&(u=s,d=p),0>d)d=Math.abs(o)*u/s>u-l?l-u:o*u/s;else if(d+u>e&&o-a>0){var x=o-n+e+r;d=x*u/s>u-l?e+r-l:e+r-u+x*u/s}return t.barpos=Math.round(d),result={size:Math.round(u),pos:t.barpos}},scrollTo:function(o,t,r){var i=this,s=i.xscroll.userConfig.gpuAcceleration?" translateZ(0) ":"",l={css:{transform:i.isY?"translateY("+o+"px)"+s:"translateX("+o+"px)"+s},duration:t,easing:r,useTransition:i.xscroll.userConfig.useTransition};i.__timer=i.__timer||new e(i.indicate,l),i.__timer.stop(),i.__timer.reset(l),i.__timer.run()},moveTo:function(o){var t=this;t.show();var r=t.xscroll.userConfig.gpuAcceleration?" translateZ(0) ":"";t.indicate.style[n]=t.isY?"translateY("+o+"px) "+r:"translateX("+o+"px) "+r,t.indicate.style[c]=""},_bindEvt:function(){var o=this;if(!o.__isEvtBind){o.__isEvtBind=!0;var t=o.isY?"y":"x",r=function(t){return"x"==t?o.xscroll.isBoundryOutLeft()||o.xscroll.isBoundryOutRight():o.xscroll.isBoundryOutTop()||o.xscroll.isBoundryOutBottom()};o.xscroll.userConfig.useTransition?(o.xscroll.on("pan",function(t){o._update(t[o.scrollTopOrLeft])}),o.xscroll.on("scrollanimate",function(r){r.zoomType&&r.zoomType==t&&o._update(r[o.scrollTopOrLeft],r.duration,r.easing)})):o.xscroll.on("scroll",function(t){o._update(t[o.scrollTopOrLeft])}),o.xscroll.on("panend",function(i){0!=Math.abs(i.velocity)||r(t)||o.hide()}),o.xscroll.on("scrollend",function(t){r()||(o._update(t[o.scrollTopOrLeft]),o.hide())})}},reset:function(){var o=this;o.pos=0,o._update()},hide:function(o,t,r){var i=this,o=o>=0?o:300,r=r>=0?r:100;i.scrollbar.style.opacity=0,i.scrollbar.style[c]=["opacity ",o,"ms "," ease-out ",r,"ms"].join("")},show:function(){var o=this;o.scrollbar.style.opacity=1,o.scrollbar.style[c]=""}}),"object"==typeof r&&r.exports?void(r.exports=d):d});