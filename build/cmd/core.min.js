define(function(t,e,n){"use strict";function i(t){i.superclass.constructor.call(this),this.userConfig=t,this.init()}{var r=t("./util"),o=t("./base"),s=(t("./animate"),t("./boundry")),c=t("./hammer"),l=500,u="ease",a=.1,d=r.prefixStyle("transform");r.prefixStyle("transition"),r.vendor?["-",r.vendor,"-transform"].join(""):"transform"}return i.Util=r,i.Plugin={},r.extend(i,o,{version:"3.0.0",init:function(){var t=this,e={preventDefault:!0,bounce:!0,boundryCheck:!0,useTransition:!0,gpuAcceleration:!0,BOUNDRY_CHECK_EASING:u,BOUNDRY_CHECK_DURATION:l,BOUNDRY_CHECK_ACCELERATION:a,clsPrefix:"xs-",useOriginScroll:!1,zoomType:"y",indicatorInsets:{top:3,bottom:3,left:3,right:3,width:3,spacing:5},stickyElements:".xs-sticky",touchAction:"auto"};t.guid=r.guid(),t.renderTo=t.userConfig.renderTo.nodeType?t.userConfig.renderTo:document.querySelector(t.userConfig.renderTo),t.__timers={};var n=JSON.parse(t.renderTo.getAttribute("xs-cfg")),i=t.userConfig=r.mix(r.mix(e,n),t.userConfig);return t.containerClsName=i.clsPrefix+"container",t.contentClsName=i.clsPrefix+"content",t.container=t.renderTo.querySelector("."+t.containerClsName),t.content=t.renderTo.querySelector("."+t.contentClsName),t.boundry=new s,t.boundry.refresh(),t},destroy:function(){var t=this;t._unBindEvt()},_initContainer:function(){},enableGPUAcceleration:function(){return this.userConfig.gpuAcceleration=!0,this},disableGPUAcceleration:function(){return this.userConfig.gpuAcceleration=!1,this},getScrollPos:function(){var t=this;return{scrollLeft:t.getScrollLeft(),scrollTop:t.getScrollTop()}},getScrollTop:function(){},getScrollLeft:function(){},scrollTo:function(t,e,n,i,r){var o=this,t=void 0===t||isNaN(t)?-o.getScrollLeft():t,e=void 0===e||isNaN(e)?-o.getScrollTop():e;o.scrollLeft(t,n,i,r),o.scrollTop(e,n,i,r)},scrollBy:function(t,e,n,i,r){this.scrollByX(t,n,i,r),this.scrollByY(e,n,i,r)},scrollLeftBy:function(t,e,n,i){this.scrollLeft(Number(t)+Number(this.getScrollLeft()),e,n,i)},scrollTopBy:function(t,e,n,i){this.scrollTop(Number(t)+Number(this.getScrollTop()),e,n,i)},scrollLeft:function(t,e,n,i){},scrollTop:function(t,e,n,i){},resetSize:function(){var t=this,e=t.userConfig,n=getComputedStyle(t.renderTo),i=(t.width=(e.width||t.renderTo.offsetWidth)-r.px2Num(n["padding-left"])-r.px2Num(n["padding-right"]),t.height=(e.height||t.renderTo.offsetHeight)-r.px2Num(n["padding-top"])-r.px2Num(n["padding-bottom"]),e.containerWidth||t.content.offsetWidth),o=e.containerHeight||t.content.offsetHeight;return t.containerWidth=i<t.width?t.width:i,t.containerHeight=o<t.height?t.height:o,t.boundry.refresh({width:t.width,height:t.height}),t},render:function(){var t=this;return t.resetSize(),t.trigger("afterrender",{type:"afterrender"}),t._bindEvt(),t.initTouchAction(),t.initStickies(),t},initTouchAction:function(){var t=this;return t.mc.set({touchAction:t.userConfig.touchAction}),t},initStickies:function(){var t,e=this,n=e.userConfig.stickyElements;e.isY=!("y"!=e.userConfig.zoomType),e.nameTop=e.isY?"top":"left",e.nameHeight=e.isY?"height":"width",e.nameWidth=e.isY?"width":"height",e._stickies="string"==typeof n?e.content.querySelectorAll(n):n,e._stickiesNum=e._stickies.length,e._stickiesPos=[];for(var i=0;i<e._stickiesNum;i++){t=e._stickies[i];var o={};o[e.nameTop]=e.isY?r.getOffsetTop(t):r.getOffsetLeft(t),o[e.nameHeight]=e.isY?t.offsetHeight:t.offsetWidth,e._stickiesPos.push(o)}return e._stickiesNum>0&&!e.stickyElement&&(e.stickyElement=document.createElement("div"),e.stickyElement.style.display="none",e.renderTo.appendChild(e.stickyElement)),e.stickyHandler(),e},stickyHandler:function(){var t=this,e=(t.userConfig.zoomType,t.isY?t.getScrollTop():t.getScrollLeft()),n=t._stickiesPos,i=[];t.curStickyIndex=void 0;for(var r=0,o=n.length;o>r;r++){var s=n[r][t.nameTop];e>s&&i.push(r)}if(!i.length)return t.stickyElement&&(t.stickyElement.style.display="none"),void(t.curStickyIndex=void 0);var c=Math.max.apply(null,i);t.curStickyIndex!==c&&(t.curStickyIndex=c,t.renderStickyElement());var l=0;if(t._stickiesPos[t.curStickyIndex+1]){var u=t._stickiesPos[t.curStickyIndex],a=t._stickiesPos[t.curStickyIndex+1];l=e+u[t.nameHeight]>a[t.nameTop]&&e+u[t.nameHeight]<a[t.nameTop]+u[t.nameHeight]?u[t.nameHeight]+e-a[t.nameTop]:0}t.stickyElement.style[d]=t.isY?"translateY(-"+l+"px) translateZ(0)":"translateX(-"+l+"px) translateZ(0)"},renderStickyElement:function(){var t=this,e=t.stickyElement,n=t.curStickyIndex,i=t._stickies[n];return e.style.display="block",e.innerHTML=i.innerHTML,e.className=i.className,e.setAttribute("style",i.getAttribute("style")),e.style.position="fixed",e.style[t.nameWidth]="100%",e.style[t.nameTop]=0,e.id=i.id,t},boundryCheck:function(){return this},boundryCheckX:function(){return this},boundryCheckY:function(){return this},_bindEvt:function(){var t=this;if(!t.___isEvtBind){t.___isEvtBind=!0;{var e=t.mc=new c.Manager(t.renderTo),n=new c.Tap,i=new c.Pan;new c.Pinch}e.add([n,i]),t.mc.on("panstart pan panend pancancel pinchstart pinchmove pinchend pinchcancel pinchin pinchout",function(e){t.trigger(e.type,e)});for(var r=["touchstart","touchmove","touchend","touchcancel"],o=0,s=r.length;s>o;o++)t.renderTo.addEventListener(r[o],function(e){t.trigger(e.type,e)});return t.mc.on("tap",function(e){1==e.tapCount?(e.type="tap",t.trigger(e.type,e)):2==e.tapCount&&(e.type="doubletap",t.trigger("doubletap",e))}),t.on("scroll",t.stickyHandler,t),t}},_unBindEvt:function(){var t=this;t.mc&&t.mc.destroy()},_resetLockConfig:function(){},stop:function(){}}),"object"==typeof n&&n.exports?void(n.exports=i):i});