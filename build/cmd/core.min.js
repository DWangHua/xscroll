define(function(e,t,n){"use strict";function i(e){i.superclass.constructor.call(this),this.userConfig=e,this.init()}{var r=e("./util"),o=e("./base"),s=(e("./animate"),e("./boundry")),c=e("./hammer"),l=500,a="ease",u=.1,d=r.prefixStyle("transform");r.prefixStyle("transition"),r.vendor?["-",r.vendor,"-transform"].join(""):"transform"}return i.Util=r,i.Plugin={},r.extend(i,o,{version:"3.0.0",init:function(){var e=this,t={preventDefault:!0,bounce:!0,boundryCheck:!0,useTransition:!0,gpuAcceleration:!0,BOUNDRY_CHECK_EASING:a,BOUNDRY_CHECK_DURATION:l,BOUNDRY_CHECK_ACCELERATION:u,clsPrefix:"xs-",useOriginScroll:!1,zoomType:"y",indicatorInsets:{top:3,bottom:3,left:3,right:3,width:3,spacing:5},stickyElements:".xs-sticky",touchAction:"auto"};e.guid=r.guid(),e.renderTo=e.userConfig.renderTo.nodeType?e.userConfig.renderTo:document.querySelector(e.userConfig.renderTo),e.__timers={};var n=JSON.parse(e.renderTo.getAttribute("xs-cfg")),i=e.userConfig=r.mix(r.mix(t,n),e.userConfig);return e.containerClsName=i.clsPrefix+"container",e.contentClsName=i.clsPrefix+"content",e.container=e.renderTo.querySelector("."+e.containerClsName),e.content=e.renderTo.querySelector("."+e.contentClsName),e.boundry=new s,e.boundry.refresh(),e},destroy:function(){var e=this;e._unBindEvt()},_initContainer:function(){},enableGPUAcceleration:function(){return this.userConfig.gpuAcceleration=!0,this},disableGPUAcceleration:function(){return this.userConfig.gpuAcceleration=!1,this},getScrollPos:function(){var e=this;return{scrollLeft:e.getScrollLeft(),scrollTop:e.getScrollTop()}},getScrollTop:function(){},getScrollLeft:function(){},scrollTo:function(e,t,n,i,r){var o=this,e=void 0===e||isNaN(e)?-o.getScrollLeft():e,t=void 0===t||isNaN(t)?-o.getScrollTop():t;o.scrollLeft(e,n,i,r),o.scrollTop(t,n,i,r)},scrollBy:function(e,t,n,i,r){this.scrollByX(e,n,i,r),this.scrollByY(t,n,i,r)},scrollLeftBy:function(e,t,n,i){this.scrollLeft(Number(e)+Number(this.getScrollLeft()),t,n,i)},scrollTopBy:function(e,t,n,i){this.scrollTop(Number(e)+Number(this.getScrollTop()),t,n,i)},scrollLeft:function(e,t,n,i){},scrollTop:function(e,t,n,i){},resetSize:function(){var e=this,t=e.userConfig,n=getComputedStyle(e.renderTo),i=(e.width=(t.width||e.renderTo.offsetWidth)-r.px2Num(n["padding-left"])-r.px2Num(n["padding-right"]),e.height=(t.height||e.renderTo.offsetHeight)-r.px2Num(n["padding-top"])-r.px2Num(n["padding-bottom"]),t.containerWidth||e.content.offsetWidth),o=t.containerHeight||e.content.offsetHeight;return e.containerWidth=i<e.width?e.width:i,e.containerHeight=o<e.height?e.height:o,e.boundry.refresh({width:e.width,height:e.height}),e},render:function(){var e=this;return e.resetSize(),e.trigger("afterrender",{type:"afterrender"}),e._bindEvt(),e.initTouchAction(),e.initStickies(),e},initTouchAction:function(){var e=this;return e.mc.set({touchAction:e.userConfig.touchAction}),e},initStickies:function(){var e,t=this,n=t.userConfig.stickyElements;t.isY=!("y"!=t.userConfig.zoomType),t.nameTop=t.isY?"top":"left",t.nameHeight=t.isY?"height":"width",t.nameWidth=t.isY?"width":"height",t._stickies="string"==typeof n?t.content.querySelectorAll(n):n,t._stickiesNum=t._stickies.length,t._stickiesPos=[];for(var i=0;i<t._stickiesNum;i++){e=t._stickies[i];var o={};o[t.nameTop]=t.isY?r.getOffsetTop(e):r.getOffsetLeft(e),o[t.nameHeight]=t.isY?e.offsetHeight:e.offsetWidth,t._stickiesPos.push(o)}return t._stickiesNum>0&&!t.stickyElement&&(t.stickyElement=document.createElement("div"),t.stickyElement.style.display="none",t.renderTo.appendChild(t.stickyElement)),t.stickyHandler(),t},stickyHandler:function(){var e=this,t=(e.userConfig.zoomType,e.isY?e.getScrollTop():e.getScrollLeft()),n=e._stickiesPos,i=[];e.curStickyIndex=void 0;for(var r=0,o=n.length;o>r;r++){var s=n[r][e.nameTop];t>s&&i.push(r)}if(!i.length)return e.stickyElement&&(e.stickyElement.style.display="none"),void(e.curStickyIndex=void 0);var c=Math.max.apply(null,i);e.curStickyIndex!==c&&(e.curStickyIndex=c,e.renderStickyElement());var l=0;if(e._stickiesPos[e.curStickyIndex+1]){var a=e._stickiesPos[e.curStickyIndex],u=e._stickiesPos[e.curStickyIndex+1];l=t+a[e.nameHeight]>u[e.nameTop]&&t+a[e.nameHeight]<u[e.nameTop]+a[e.nameHeight]?a[e.nameHeight]+t-u[e.nameTop]:0}e.stickyElement.style[d]=e.isY?"translateY(-"+l+"px) translateZ(0)":"translateX(-"+l+"px) translateZ(0)"},renderStickyElement:function(){var e=this,t=e.stickyElement,n=e.curStickyIndex,i=e._stickies[n];return t.style.display="block",t.innerHTML=i.innerHTML,t.className=i.className,t.style=i.style,t.style.position="fixed",t.style[e.nameWidth]="100%",t.style[e.nameTop]=0,t.id=i.id,e},_triggerClick:function(e){var t=e.target;if(!/(SELECT|INPUT|TEXTAREA)/i.test(t.tagName)){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,e.view,1,t.screenX,t.screenY,t.clientX,t.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),t.dispatchEvent(n)}},boundryCheck:function(){return this},boundryCheckX:function(){return this},boundryCheckY:function(){return this},_bindEvt:function(){var e=this;if(!e.___isEvtBind){e.___isEvtBind=!0;{var t=e.mc=new c.Manager(e.renderTo),n=new c.Tap,i=new c.Pan;new c.Pinch}t.add([n,i]),e.mc.on("panstart pan panend pancancel pinchstart pinchmove pinchend pinchcancel pinchin pinchout",function(t){e.trigger(t.type,t)});for(var r=["touchstart","touchmove","touchend","touchcancel"],o=0,s=r.length;s>o;o++)e.renderTo.addEventListener(r[o],function(t){e.trigger(t.type,t)});return e.mc.on("tap",function(t){1==t.tapCount?(t.type="tap",e.trigger(t.type,t)):2==t.tapCount&&(t.type="doubletap",e.trigger("doubletap",t))}),e.on("scroll",e.stickyHandler,e),e}},_unBindEvt:function(){var e=this;e.mc&&e.mc.destroy()},_resetLockConfig:function(){},stop:function(){}}),"object"==typeof n&&n.exports?void(n.exports=i):i});